<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Threading | OpenHPS</title>

<meta name="description" content="A modular open source hybrid positioning system developed in TypeScript. OpenHPS allows you to develop prototypes or production ready positioning systems for various use cases.">
<meta name="robots" content="index,follow">
<meta name="author" content="Maxim Van de Wynckel">

<link rel="canonical" href="https://openhps.org/docs/v1/workernode/">

<meta property="og:title" content="Threading | OpenHPS">
<meta property="og:type" content="article">

<meta property="og:url" content="https://openhps.org/docs/v1/workernode/">
<meta property="og:description" content="A modular open source hybrid positioning system developed in TypeScript. OpenHPS allows you to develop prototypes or production ready positioning systems for various use cases.">
<meta property="og:image" content="https://openhps.org/images/social/summary-large.png">

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@OpenHPS">
<meta name="twitter:url" content="https://openhps.org/docs/v1/workernode/">
<meta name="twitter:title" content="Threading | OpenHPS">
<meta name="twitter:description" content="A modular open source hybrid positioning system developed in TypeScript. OpenHPS allows you to develop prototypes or production ready positioning systems for various use cases.">
<meta name="twitter:image" content="https://openhps.org/images/social/summary-large.png">


    <meta name="keywords" content="hybrid positioning system typescript javascript open source" />

    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700|Source+Code+Pro:400,700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
    <link rel="stylesheet" href="/css/main.css?version=8">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
    
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/svg+xml" href="/favicon.svg"></link>
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
    
    <meta name="theme-color" content="#9c0000">

    <script async src="https://www.googletagmanager.com/gtag/js?id=G-QY7ESJZX3K"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-QY7ESJZX3K');
    </script>
</head>


  <body>
    <header class="site-header">
    <div class="container">
        <a href="/" class="logo"></a>
  
        <nav class="site-nav">
          <input type="checkbox" id="nav-trigger" class="nav-trigger" />
          <label for="nav-trigger">
            <span class="menu-icon">
              <svg viewBox="0 0 18 15" width="18px" height="15px">
                <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
              </svg>
            </span>
          </label>
  
          <div class="trigger">
              <a class="page-link" href="/docs/introduction">Docs</a>
              <a class="page-link" href="/posts">Blog</a>
              <a class="page-link" href="https://github.com/OpenHPS">GitHub</a>
          </div>
        </nav>
    </div>
</header>

    <section class="content" id="content">
      
<div class="container main">
  <div class="row">
    <div class="col-sm-3">
      <nav class="navigation">
  <ul>
    
      
      <h3>Documentation</h3>
      
      
      <li >
        <a href="/docs/introduction/" >Introduction</a>
        
      </li>
    
      
      
      <li >
        <a href="/docs/installation/" >Installation</a>
        
      </li>
    
      
      
      <li >
        <a href="/docs/modules/" >Modules</a>
        
      </li>
    
      
      <h3>Basic Concepts</h3>
      
      
      <li >
        <a href="/docs/v1/dataobject/" >Data Object</a>
        
      </li>
    
      
      
      <li >
        <a href="/docs/v1/dataframe/" >Data Frame</a>
        
      </li>
    
      
      
      <li >
        <a href="/docs/v1/unit/" >Standard Units</a>
        
      </li>
    
      
      
      <li >
        <a href="/docs/v1/position/" >Position and Orientation</a>
        
      </li>
    
      
      
      <li >
        <a href="/docs/v1/referencespace/" >Reference Space</a>
        
      </li>
    
      
      
      <li >
        <a href="/docs/v1/model/" >Positioning Model</a>
        
      </li>
    
      
      
      <li >
        <a href="/docs/v1/sourcenode/" >Source Node</a>
        
      </li>
    
      
      
      <li >
        <a href="/docs/v1/processingnode/" >Processing Node</a>
        
      </li>
    
      
      
      <li >
        <a href="/docs/v1/sinknode/" >Sink Node</a>
        
      </li>
    
      
      
      <li >
        <a href="/docs/v1/service/" >Services</a>
        
      </li>
    
      
      <h3>Advanced Concepts</h3>
      
      
      <li >
        <a href="/docs/v1/remoteservice/" >Remote Service</a>
        
      </li>
    
      
      
      <li class="selected">
        <a href="/docs/v1/workernode/" class="current">Threading</a>
        
        <nav class="toc" >
        <ul><li><a href="#creating-a-threaded-node-with-callback">Creating a threaded node with callback</a></li><li><a href="#creating-a-threaded-node-with-file">Creating a threaded node with file</a></li></ul>
      </nav>
        
      </li>
    
      
      <h3>Tutorials</h3>
      
      
      <li >
        <a href="/docs/tutorials/floordetection/" >Building and Floor Detection</a>
        
      </li>
    
      
      <h3>Miscellaneous</h3>
      
      
      <li >
        <a href="/docs/examples/" >Examples</a>
        
      </li>
    
  </ul>
</nav>
    </div>
    <div class="col-sm-9 typography">
      <h1>Threading</h1>
      <p>Data frames and objects are serializable by default through the use of decorators. This allows data to be transmitted between
threads. Threading is supported in OpenHPS through worker nodes and graphs that run one or more nodes in a pool of threads.</p>
<h2 id="creating-a-threaded-node-with-callback" tabindex="-1">Creating a threaded node with callback</h2>
<p><strong>Master File</strong></p>
<pre class="shiki dark-plus twoslash lsp" style="background-color: #1E1E1E; color: #D4D4D4"><div class="language-id">ts</div><div class='code-container'><code><div class='line'><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE"><data-lsp lsp='(alias) class ModelBuilder&lt;In extends DataFrame, Out extends DataFrame>&#10;import ModelBuilder' >ModelBuilder</data-lsp></span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE"><data-lsp lsp='(alias) class WorkerNode&lt;In extends DataFrame, Out extends DataFrame>&#10;import WorkerNode' >WorkerNode</data-lsp></span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&apos;@openhps/core&apos;</span><span style="color: #D4D4D4">;</span></div><div class='line'><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">*</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">as</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE"><data-lsp lsp='(alias) namespace path&#10;(alias) const path: PlatformPath&#10;import path' >path</data-lsp></span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&apos;path&apos;</span><span style="color: #D4D4D4">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #9CDCFE"><data-lsp lsp='(alias) class ModelBuilder&lt;In extends DataFrame, Out extends DataFrame>&#10;import ModelBuilder' >ModelBuilder</data-lsp></span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA"><data-lsp lsp='(method) ModelBuilder&lt;In extends DataFrame, Out extends DataFrame>.create&lt;DataFrame, DataFrame>(): ModelBuilder&lt;DataFrame, DataFrame>' >create</data-lsp></span><span style="color: #D4D4D4">()</span></div><div class='line'><span style="color: #D4D4D4">    .</span><span style="color: #DCDCAA"><data-lsp lsp='(method) GraphBuilder&lt;DataFrame, DataFrame>.from(...nodes: (string | GraphNode&lt;any, any>)[]): GraphShapeBuilder&lt;any>' >from</data-lsp></span><span style="color: #D4D4D4">()</span></div><div class='line'><span style="color: #D4D4D4">    .</span><span style="color: #DCDCAA"><data-lsp lsp='(method) GraphShapeBuilder&lt;any>.via(...nodes: (string | GraphNode&lt;any, any> | GraphShape&lt;any, any> | GraphBuilder&lt;any, any>)[]): GraphShapeBuilder&lt;any>' >via</data-lsp></span><span style="color: #D4D4D4">(</span></div><div class='line'><span style="color: #D4D4D4">        </span><span style="color: #569CD6">new</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA"><data-lsp lsp='(alias) new WorkerNode&lt;any, any>(builderCallback: (builder: GraphShapeBuilder&lt;ModelBuilder&lt;any, any>>, modelBuilder?: ModelBuilder&lt;any, any>, args?: any) => void, options?: WorkerNodeOptions): WorkerNode&lt;...> (+2 overloads)&#10;import WorkerNode' >WorkerNode</data-lsp></span><span style="color: #D4D4D4">(</span></div><div class='line'><span style="color: #D4D4D4">            (</span><span style="color: #9CDCFE"><data-lsp lsp='(parameter) builder: GraphShapeBuilder&lt;ModelBuilder&lt;any, any>>' >builder</data-lsp></span><span style="color: #D4D4D4">) </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></div><div class='line'><span style="color: #D4D4D4">                </span><span style="color: #569CD6">const</span><span style="color: #D4D4D4"> { </span><span style="color: #4FC1FF"><data-lsp lsp='const SomeNode: any' >SomeNode</data-lsp></span><span style="color: #D4D4D4"> } = </span><span style="color: #DCDCAA"><data-lsp lsp='var require: NodeRequire&#10;(id: string) => any' >require</data-lsp></span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE"><data-lsp lsp='(alias) namespace path&#10;(alias) const path: PlatformPath&#10;import path' >path</data-lsp></span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA"><data-lsp lsp='(method) path.PlatformPath.join(...paths: string[]): string' >join</data-lsp></span><span style="color: #D4D4D4">(</span></div><div class='line'><span style="color: #D4D4D4">                    </span><span style="color: #9CDCFE"><data-lsp lsp='var __dirname: string' >__dirname</data-lsp></span><span style="color: #D4D4D4">,</span></div><div class='line'><span style="color: #D4D4D4">                    </span><span style="color: #CE9178">&apos;./nodes/SomeNode&apos;</span><span style="color: #D4D4D4">,</span></div><div class='line'><span style="color: #D4D4D4">                ));</span></div><div class='line'><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE"><data-lsp lsp='(parameter) builder: GraphShapeBuilder&lt;ModelBuilder&lt;any, any>>' >builder</data-lsp></span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA"><data-lsp lsp='(method) GraphShapeBuilder&lt;ModelBuilder&lt;any, any>>.via(...nodes: (string | GraphNode&lt;any, any> | GraphShape&lt;any, any> | GraphBuilder&lt;any, any>)[]): GraphShapeBuilder&lt;ModelBuilder&lt;any, any>>' >via</data-lsp></span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">new</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA"><data-lsp lsp='const SomeNode: any' >SomeNode</data-lsp></span><span style="color: #D4D4D4">());</span></div><div class='line'><span style="color: #D4D4D4">            },</span></div><div class='line'><span style="color: #D4D4D4">            {</span></div><div class='line'><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE"><data-lsp lsp='(property) WorkerOptions.directory?: string' >directory</data-lsp>:</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE"><data-lsp lsp='var __dirname: string' >__dirname</data-lsp></span><span style="color: #D4D4D4">,</span></div><div class='line'><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE"><data-lsp lsp='(property) WorkerOptions.poolSize?: number' >poolSize</data-lsp>:</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">,</span></div><div class='line'><span style="color: #D4D4D4">            },</span></div><div class='line'><span style="color: #D4D4D4">        ),</span></div><div class='line'><span style="color: #D4D4D4">    )</span></div><div class='line'><span style="color: #D4D4D4">    .</span><span style="color: #DCDCAA"><data-lsp lsp='(method) GraphShapeBuilder&lt;any>.to(...nodes: (string | SinkNode&lt;any>)[]): any' >to</data-lsp></span><span style="color: #D4D4D4">(</span><span style="color: #6A9955">/* ... */</span><span style="color: #D4D4D4">)</span></div><div class='line'><span style="color: #D4D4D4">    .</span><span style="color: #DCDCAA"><data-lsp lsp='any' >build</data-lsp></span><span style="color: #D4D4D4">();</span></div></code></div></pre>
<h2 id="creating-a-threaded-node-with-file" tabindex="-1">Creating a threaded node with file</h2>
<p><strong>Master File</strong></p>
<pre class="shiki dark-plus twoslash lsp" style="background-color: #1E1E1E; color: #D4D4D4"><div class="language-id">ts</div><div class='code-container'><code><div class='line'><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span><span style="color: #9CDCFE"><data-lsp lsp='(alias) class ModelBuilder&lt;In extends DataFrame, Out extends DataFrame>&#10;import ModelBuilder' >ModelBuilder</data-lsp></span><span style="color: #D4D4D4">, </span><span style="color: #9CDCFE"><data-lsp lsp='(alias) class WorkerNode&lt;In extends DataFrame, Out extends DataFrame>&#10;import WorkerNode' >WorkerNode</data-lsp></span><span style="color: #D4D4D4"> } </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&apos;@openhps/core&apos;</span><span style="color: #D4D4D4">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #9CDCFE"><data-lsp lsp='(alias) class ModelBuilder&lt;In extends DataFrame, Out extends DataFrame>&#10;import ModelBuilder' >ModelBuilder</data-lsp></span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA"><data-lsp lsp='(method) ModelBuilder&lt;In extends DataFrame, Out extends DataFrame>.create&lt;DataFrame, DataFrame>(): ModelBuilder&lt;DataFrame, DataFrame>' >create</data-lsp></span><span style="color: #D4D4D4">()</span></div><div class='line'><span style="color: #D4D4D4">    .</span><span style="color: #DCDCAA"><data-lsp lsp='(method) GraphBuilder&lt;DataFrame, DataFrame>.from(...nodes: (string | GraphNode&lt;any, any>)[]): GraphShapeBuilder&lt;any>' >from</data-lsp></span><span style="color: #D4D4D4">()</span></div><div class='line'><span style="color: #D4D4D4">    .</span><span style="color: #DCDCAA"><data-lsp lsp='(method) GraphShapeBuilder&lt;any>.via(...nodes: (string | GraphNode&lt;any, any> | GraphShape&lt;any, any> | GraphBuilder&lt;any, any>)[]): GraphShapeBuilder&lt;any>' >via</data-lsp></span><span style="color: #D4D4D4">(</span></div><div class='line'><span style="color: #D4D4D4">        </span><span style="color: #569CD6">new</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA"><data-lsp lsp='(alias) new WorkerNode&lt;any, any>(file: string, options?: WorkerNodeOptions): WorkerNode&lt;any, any> (+2 overloads)&#10;import WorkerNode' >WorkerNode</data-lsp></span><span style="color: #D4D4D4">(</span><span style="color: #CE9178">"./SomeThread.ts"</span><span style="color: #D4D4D4">,</span></div><div class='line'><span style="color: #D4D4D4">            {</span></div><div class='line'><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE"><data-lsp lsp='(property) WorkerOptions.directory?: string' >directory</data-lsp>:</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE"><data-lsp lsp='var __dirname: string' >__dirname</data-lsp></span><span style="color: #D4D4D4">,</span></div><div class='line'><span style="color: #D4D4D4">                </span><span style="color: #9CDCFE"><data-lsp lsp='(property) WorkerOptions.poolSize?: number' >poolSize</data-lsp>:</span><span style="color: #D4D4D4"> </span><span style="color: #B5CEA8">1</span><span style="color: #D4D4D4">,</span></div><div class='line'><span style="color: #D4D4D4">            },</span></div><div class='line'><span style="color: #D4D4D4">        ),</span></div><div class='line'><span style="color: #D4D4D4">    )</span></div><div class='line'><span style="color: #D4D4D4">    .</span><span style="color: #DCDCAA"><data-lsp lsp='(method) GraphShapeBuilder&lt;any>.to(...nodes: (string | SinkNode&lt;any>)[]): any' >to</data-lsp></span><span style="color: #D4D4D4">(</span><span style="color: #6A9955">/* ... */</span><span style="color: #D4D4D4">)</span></div><div class='line'><span style="color: #D4D4D4">    .</span><span style="color: #DCDCAA"><data-lsp lsp='any' >build</data-lsp></span><span style="color: #D4D4D4">();</span></div></code></div></pre>
<p><strong>Worker File</strong></p>
<pre class="shiki dark-plus twoslash lsp" style="background-color: #1E1E1E; color: #D4D4D4"><div class="language-id">ts</div><div class='code-container'><code><div class='line'><span style="color: #C586C0">import</span><span style="color: #D4D4D4"> { </span></div><div class='line'><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE"><data-lsp lsp='(alias) class CallbackNode&lt;InOut extends DataFrame>&#10;import CallbackNode' >CallbackNode</data-lsp></span><span style="color: #D4D4D4">, </span></div><div class='line'><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE"><data-lsp lsp='(alias) class DataFrame&#10;import DataFrame' >DataFrame</data-lsp></span><span style="color: #D4D4D4">, </span></div><div class='line'><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE"><data-lsp lsp='(alias) class DataObject&#10;import DataObject' >DataObject</data-lsp></span><span style="color: #D4D4D4">, </span></div><div class='line'><span style="color: #D4D4D4">    </span><span style="color: #9CDCFE"><data-lsp lsp='(alias) class ModelBuilder&lt;In extends DataFrame, Out extends DataFrame>&#10;import ModelBuilder' >ModelBuilder</data-lsp></span></div><div class='line'><span style="color: #D4D4D4">} </span><span style="color: #C586C0">from</span><span style="color: #D4D4D4"> </span><span style="color: #CE9178">&apos;@openhps/core&apos;</span><span style="color: #D4D4D4">;</span></div><div class='line'>&nbsp;</div><div class='line'><span style="color: #C586C0">export</span><span style="color: #D4D4D4"> </span><span style="color: #C586C0">default</span><span style="color: #D4D4D4"> </span><span style="color: #9CDCFE"><data-lsp lsp='(alias) class ModelBuilder&lt;In extends DataFrame, Out extends DataFrame>&#10;import ModelBuilder' >ModelBuilder</data-lsp></span><span style="color: #D4D4D4">.</span><span style="color: #DCDCAA"><data-lsp lsp='(method) ModelBuilder&lt;In extends DataFrame, Out extends DataFrame>.create&lt;DataFrame, DataFrame>(): ModelBuilder&lt;DataFrame, DataFrame>' >create</data-lsp></span><span style="color: #D4D4D4">()</span></div><div class='line'><span style="color: #D4D4D4">    .</span><span style="color: #DCDCAA"><data-lsp lsp='(method) GraphBuilder&lt;DataFrame, DataFrame>.from(...nodes: (string | GraphNode&lt;any, any>)[]): GraphShapeBuilder&lt;any>' >from</data-lsp></span><span style="color: #D4D4D4">()</span></div><div class='line'><span style="color: #D4D4D4">    .</span><span style="color: #DCDCAA"><data-lsp lsp='(method) GraphShapeBuilder&lt;any>.via(...nodes: (string | GraphNode&lt;any, any> | GraphShape&lt;any, any> | GraphBuilder&lt;any, any>)[]): GraphShapeBuilder&lt;any>' >via</data-lsp></span><span style="color: #D4D4D4">(</span><span style="color: #569CD6">new</span><span style="color: #D4D4D4"> </span><span style="color: #DCDCAA"><data-lsp lsp='(alias) new CallbackNode&lt;any>(pushCallback?: (frame: any) => void, pullCallback?: () => any, options?: CallbackNodeOptions): CallbackNode&lt;any>&#10;import CallbackNode' >CallbackNode</data-lsp></span><span style="color: #D4D4D4">(</span><span style="color: #9CDCFE"><data-lsp lsp='(parameter) frame: any' >frame</data-lsp></span><span style="color: #D4D4D4"> </span><span style="color: #569CD6">=&gt;</span><span style="color: #D4D4D4"> {</span></div><div class='line'><span style="color: #D4D4D4">        </span><span style="color: #6A9955">// Do something time consuming ...</span></div><div class='line'><span style="color: #D4D4D4">    }))</span></div><div class='line'><span style="color: #D4D4D4">    .</span><span style="color: #DCDCAA"><data-lsp lsp='(method) GraphShapeBuilder&lt;any>.to(...nodes: (string | SinkNode&lt;any>)[]): any' >to</data-lsp></span><span style="color: #D4D4D4">();</span></div></code></div></pre>

    </div>
  </div>
</div>

    </section>

    <script src="/scripts/twoslash.js"></script>
<footer>
    &copy; OpenHPS 2019-2022. This site is powered by <a href="https://www.netlify.com/">Netlify</a> | 
    <a href="https://github.com/OpenHPS/openhps-site/blob/master/./docs/v1/workernode.md">Edit this page on GitHub</a>
</footer>

  </body>
</html>
